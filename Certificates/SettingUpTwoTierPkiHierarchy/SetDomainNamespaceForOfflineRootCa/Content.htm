<html>
	<head>
		<title>Content</title>
	</head>
  	<body>
	
    <table width="100%" border="0" cellpadding="10">
            <tr>
                <td width="100%" align="left" valign="top">In this step, since the root CA is offline and has no ties to any network, a reference somehow has to be made to the domain that this CA belongs to. On an Enterprise CA, this is set automatically since it is a member of the domain. In this case, this CA is a Standalone CA that is not a member of the domain, and so this value needs to be set manually. This is done by storing the domain information in the registry using the 'certutil' command. To learn how to do this, proceed with the following steps...</td>
                
                
          </tr>
        </table>
    
    	<hr>
    
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Begin first by selecting <strong>'Start'</strong> at the bottom left corner of your  screen.</span></li>
            </ul>                  <br></td>
                
                <td align="right">
                    <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/1.jpg" width="278" height="128"></td>
                        </tr>
                  </table>
              </td>
          </tr>
        </table>
        
        <hr> 
   
		<table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Then open the&nbsp;<strong>'Command Prompt'</strong>.</span></li>
            </ul></td>
                
                <td align="right">
                  <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/ADPrep/1.jpg" width="405" height="456"></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        
        <hr> 
		
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Once the command prompt is open, enter in the command <strong>'certutil'</strong>.</span></li>
            </ul></td>
                
                <td align="right">
              <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="1.jpg" width="815" height="393"></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        
        <hr> 
        
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Followd by <strong>'-setreg'</strong>. There a lot of these commands that are available, but in this case, we only want use 'certutil' to set values in the registry that the Certificate Authority will use later on.</span></li>
              </ul></td>
                
                <td align="right">
              <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="2.jpg" width="815" height="393"></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">The next parameter is <strong>'ca\'</strong>.</span></li>
                </ul></td>
                
                <td align="right">
              <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="3.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Followed by the setting that needs to be configured. In this case, it is <strong>'DSConfigDN'</strong>.</span> </li>
                  <br>
                  <li>This setting records the fully qualified domain name of the domain namespace that the CA belongs to. The fully qualified distinguished name becomes part of the certificate issuer name and is also used by several variables that are used to set the CRL and authority information access. On an enterprise CA, this is set automatically. On an offline CA that is not a domain member, you must manually set the value of DSConfigDN so that the fully qualified distinguished name appears in certificates and CRLs.</li>
            </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="4.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li>Next is the parameter where the fully qualified domain name will be entered. It is important that when you enter in the domain name, you use the correct syntax, starting with <strong>'CN=Configuration'</strong>.</li>
              </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="5.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul type="disc">
                <li><span dir="LTR">Then enter <strong>',DC=' </strong> followed by the name of your domain, which in this case is <strong>'bronstutorials'</strong>.</span></li>
      </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="6.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>And then finally enter in <strong>',DC='</strong> followed by the domain suffix, which in this case is <strong>'local'</strong>.</li>
                <br>
                <li>When finished, press <strong>'Enter'</strong>.</li>
            </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="7.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
              <li>After the command has been entered, a message will appear stating that the certificate service may need to be restarted. In this case, the service does need to be restared, but before this is done, we need to enter in one more command.</li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="8.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
              <li><span dir="LTR"><span dir="LTR">Now enter in the following command, <strong>'certutil -setreg ca\DSDomainDN &quot;DC=bronstutorials,DC=local&quot;'</strong>.</span></span> This setting identifies the domain that is a parent to the configuration container used by the CA.</li>
              <br>
              <li>When finished, press <strong>'Enter'</strong>.</li>
        </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="9.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Again, after the command has been entered, a message will appear stating that the certificate service may need to be restarted. This time, since the two commands have been entered needed to complete this step, we can now go ahead and restart the certification service.</li>
            </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="10.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">There is a couple of ways in which the certificate service can be restarted.</span> The first way is by command line. To do this, begin by entering in the command <strong>'net stop certsvc'</strong>.</li>
                <br>
                <li>Then press <strong>'Enter'</strong>.</li>
            </ul></td>
                
                <td align="right">
              <table width="600" border="0">
                        <tr>
                            <td align="center"><img src="10a.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">The command that you entered will stop the certificate service.</span></li>
    </ul></td>
                
                <td align="right">
              <table width="600" border="0">
                        <tr>
                            <td align="center"><img src="10b.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Once the certificate service has stopped, the next thing we'll need to do is start the service back up.</span></li>
    </ul></td>
                
                <td align="right">
              <table width="600" border="0">
                        <tr>
                            <td align="center"><img src="10c.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">To do this, enter in the command <strong>'net start certsvc'</strong>.</span></li>
                <br>
                <li>Then press <strong>'Enter'</strong>.</li>
        </ul></td>
                
                <td align="right">
              <table width="600" border="0">
                        <tr>
                            <td align="center"><img src="10d.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">After running this command, the certificate service will start back up.</span></li>
    </ul></td>
                
                <td align="right">
              <table width="600" border="0">
                        <tr>
                            <td align="center"><img src="10e.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Another way to restart the certificate service is through the Certification Authority interface.</span></li>
</ul></td>
                
                <td align="right">
              <table width="600" border="0">
                        <tr>
                            <td align="center"><img src="10f.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">To do this, begin  by selecting&nbsp;<strong>'Start'</strong>&nbsp;at the bottom left corner of your screen.</span></li>
    </ul></td>
                
                <td align="right">
              <table width="600" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/1.jpg" width="278" height="128"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Then go to&nbsp;<strong>'Administrative Tools'</strong>...</span></li>
</ul></td>
                
                <td align="right">
              <table width="550" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/2.jpg" width="405" height="456"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Then&nbsp;<strong>'Certification Authority'</strong>...</span></li>
    </ul></td>
                
                <td align="right">
              <table width="500" border="0">
                        <tr>
                            <td align="center"><img src="11.jpg" width="252" height="406"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
        <li><span dir="LTR">Once in Certification Authority, right-click the root node for the CA</span>, which in this case is <strong>'RootCA'</strong>.</li></ul></td>
                
                <td align="right">
              <table width="500" border="0">
                        <tr>
                            <td align="center"><img src="12.jpg" width="360" height="135"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
            <li>Then select <strong>'All Tasks'</strong>.</li></ul></td>
                
                <td align="right">
              <table width="400" border="0">
                        <tr>
                            <td align="center"><img src="13.jpg" width="93" height="101"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
            <li>And then <strong>'Stop Service'</strong>.</li></ul></td>
                
                <td align="right">
              <table width="400" border="0">
                        <tr>
                            <td align="center"><img src="14.jpg" width="159" height="135"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Now that the service is stopped, we want to start the service back up. To do this, <span dir="LTR">right-click the root node for the CA</span>, which again is in this case <strong>'RootCA'</strong>.</li>
        </ul></td>
                
                <td align="right">
              <table width="400" border="0">
                        <tr>
                            <td align="center"><img src="15.jpg" width="360" height="135"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
            <li>Then select <strong>'All Tasks'</strong>.</li>
            </ul></td>
                
                <td align="right">
              <table width="400" border="0">
                        <tr>
                            <td align="center"><img src="13.jpg" width="93" height="101"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>And then finally <strong>'Start Service'</strong>.</li>
      </ul></td>
                
                <td align="right">
              <table width="400" border="0">
                        <tr>
                            <td align="center"><img src="16.jpg" width="159" height="135"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
    </body>
</html>