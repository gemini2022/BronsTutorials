<html>
	<head>
		<title>Content</title>
	</head>
  	<body>
	
    <table width="100%" border="0" cellpadding="10">
            <tr>
                <td width="100%" align="left" valign="top"><p>Users who lose a private key will be unable to recover data that is encrypted with that key. In this next step, we will demonstrate how we can recover this key.&nbsp; To learn how to do this, proceed with the following steps...</p></td>
                
                
          </tr>
        </table>
    
    	
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Begin first by selecting&nbsp;<strong>'Start'</strong>&nbsp;at the bottom left corner of your screen.</span></li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/1.jpg" width="278" height="128"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Then go to&nbsp;<strong>'Administrative Tools'</strong>...</span></li>
    </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/2.jpg" width="405" height="456"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Then&nbsp;<strong>'Certification Authority'</strong>...</span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../SettingUpTwoTierPkiHierarchy/SetDomainNamespaceForOfflineRootCa/11.jpg" width="252" height="406"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Once in Certification Authority, expand the root node for the CA</span>, which in this case is&nbsp;<strong>'EnterpirseCA'</strong>.</li>
    </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../Autoenrollment/GroupPolicy/CreateDuplicateTemplate/6.jpg" width="419" height="135"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Then select&nbsp;<strong>'Issued Certificates'</strong>.</span></span></li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../SettingUpTwoTierPkiHierarchy/ExportCertificate/1.jpg" width="360" height="176"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Once 'Issued Certificates' is selected, click on <strong>'View'</strong>.</span></span></li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="1.jpg" width="360" height="193"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>And then select&nbsp;<strong>'Add/Remove Columns...'</strong>.</li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="2.jpg" width="161" height="66"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">The column we want to add is at the top of the list, so we need to first scroll up.</span></span></li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="3.jpg" width="525" height="305"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>And then select <strong>'Archived Key'</strong>.</li></ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="4.jpg" width="525" height="305"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">And press <strong>'Add'</strong>.</span></span></li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="5.jpg" width="525" height="305"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>And then <strong>'OK'</strong>.</li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="6.jpg" width="525" height="305"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Now, if we take a look at our issued certificates, the issued certificate we are interested in is the EFS certificate we created earlier with key archival enabled.</li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="7.jpg" width="550" height="176"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Because we added the 'Archived Key' column, we can now confirm that this certificate is actually key archive enabled. To do this, we need to first scroll to the far right of the screen.</li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="8.jpg" width="550" height="176"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Once we scroll to the far right of the screen, we can then see that the certificate is actually key archived enabled.</li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="9.jpg" width="550" height="176"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Now that we have confirmed that the key for the EFS certificate can be recovered, we can begin the process of doing just that, recovering the key. To do this, <span dir="LTR">begin  by selecting&nbsp;<strong>'Start'</strong>&nbsp;at the bottom left corner of your screen.</span></li>
          </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/1.jpg" width="278" height="128"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Then open the&nbsp;<strong>'Command Prompt'</strong>.</li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/ADPrep/1.jpg" width="405" height="456"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Once in the command prompt,  run the command&nbsp;<strong>'certutil'</strong>.</li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../SettingUpTwoTierPkiHierarchy/SetDomainNamespaceForOfflineRootCa/1.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Followed by <strong>'-getkey'</strong>.</li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="10.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Next, we need to enter in some information that identifies what certificate we want to recover the key from. There are five types of values that can be entered:</li>
                <ul>
                  <li>Certificate serial number (without spaces)</li>
                  <li>Certificate's hash value or thumbprint (without spaces)</li>
                  <li>User's Common Name (CN)</li>
                  <li>User principal name (UPN)</li>
                  <li>User's domain alias</li>
                </ul>
                <br>
                <li>For this example, we will use a UPN value to identify the certificate we want to recover the key from. In this case, the UPN value is <strong>'jdoe@bronstutorials.local'</strong>. If only one matching certificate is found, it is saved to the file specified by OutputFileName. If more than one certificate is found, Certutil.exe displays the serial numbers and other details for each certificate.</li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="11.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>We next have to specify the path and name of the file that the retrieved certificate and private key are saved in. If only the name is specified, the file will be saved in the current directory. For this example, we will provide the location of the file, which will be in this case, on the <strong>'C'</strong> drive.</li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="12.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>And then, we will name the file <strong>'JaneDoeArchivedKey'</strong>.</li>
                <br>
                <li>Press <strong>'Enter'</strong>.</li>
            </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="13.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>The file has now been created and saved to the location specified.</li>
            </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="14.jpg" width="815" height="393"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
    </body>
</html>