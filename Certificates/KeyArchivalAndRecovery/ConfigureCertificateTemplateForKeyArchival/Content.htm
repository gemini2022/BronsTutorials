<html>
	<head>
		<title>Content</title>
	</head>
  	<body>
	
    <table width="100%" border="0" cellpadding="10">
            <tr>
                <td width="100%" align="left" valign="top"><p>The key archival process takes place when a certificate is issued. Therefore, a certificate template must be modified to archive keys before any certificates are issued based on this template. Key archival is strongly recommended for use with the Basic Encrypting File System (EFS) certificate template in order to protect users from data loss, but it can also be useful when applied to other types of certificates. To learn how to do this, proceed with the following steps...</p></td>
                
                
          </tr>
        </table>
    
    	
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Begin first by selecting&nbsp;<strong>'Start'</strong>&nbsp;at the bottom left corner of your screen.</span></li>
</ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/1.jpg" width="278" height="128"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Then go to&nbsp;<strong>'Administrative Tools'</strong>...</span></li>
    </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/2.jpg" width="405" height="456"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Then&nbsp;<strong>'Certification Authority'</strong>...</span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../SettingUpTwoTierPkiHierarchy/SetDomainNamespaceForOfflineRootCa/11.jpg" width="252" height="406"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Once in Certification Authority, expand the root node for the CA</span>, which in this case is&nbsp;<strong>'EnterpirseCA'</strong>.</li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../Autoenrollment/GroupPolicy/CreateDuplicateTemplate/6.jpg" width="419" height="135"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Then right-click&nbsp;<strong>'Certificate Templates'</strong>.</span></span></li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../Autoenrollment/GroupPolicy/CreateDuplicateTemplate/7.jpg" width="360" height="192"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">And select&nbsp;<strong>'Manage'</strong>.</span></span></li>
    </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../Autoenrollment/GroupPolicy/CreateDuplicateTemplate/8.jpg" width="82" height="101"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>The next step is to choose the template you wish to duplicate. In this case, the certificate template we will duplicate is the&nbsp;<strong>'Smartcard User'</strong>&nbsp;template. To duplicate this template, right-click it.</li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="1.jpg" width="876" height="670"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">And select&nbsp;<strong>'Duplicate Template'</strong>.</span></span></li>
  </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../Autoenrollment/GroupPolicy/CreateDuplicateTemplate/10.jpg" width="135" height="101"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Next, select the template version that is appropriate for your deployment. In this case, we will select&nbsp;<strong>'Windows Server 2003 Enterprise'</strong> because Windows Server 2008 Enterprise uses CNG (the new cryptographic subsystem) which does not support the typical smart card.</li>
                <br>
                <li>Press <strong>'OK'</strong>.</li>
            </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center"><img src="../../SmartCardCertificateEnrollment/DuplicateSmartCardTemplate/2.jpg" width="396" height="243"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Once you press 'OK' on the previous dialogue box, the properties of the new template will appear. On the 'General' tab, you first have the option to rename the template display name, or keep the default setting.</li>
    </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>In this case, we will rename the template&nbsp;<strong>'Smart Card User Template'</strong>.</li>
    </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>More options on this tab can be configured, such as the 'Validity Period' and the 'Renewal Period', but for this demonstration we will leave everything else with the default settings.</li>
    </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Next, select the <strong>'Reqeust Handling'</strong> tab.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Once on the 'Request Handling' tab, the first thing we need to do is change this template's purpose. To do this, select the <strong>'Purpose'</strong> dropdown.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">And choose the option <strong>'Signature and smartcard logon'</strong>.</span></span></li>
            </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Now, select the <strong>'CSPs...'</strong> button at the bottom of the form.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Here, we need to select the CSP that will be used for the smart cards. To do this, first select the option <strong>'Request must use one of the following CSPs'</strong>.</span></span></li>
            </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Then select the CSP that meets your needs. In this case we will select the option <strong>'Microsoft Base Smart Card Crypto Provider'</strong>.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Once a selection has been made, press <strong>'OK'</strong>.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Next, we need to configure some options on the <strong>'Issuance Requirements'</strong> tab.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Once on the 'Issuance Requirements' tab, the first thing we need to do is select the option <strong>'This number of authorized signatures'</strong>.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">And leave it on the default of <strong>'1'</strong>.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>Next, make sure this field is left on the default option of <strong>'Application policy'</strong>.</li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Then we need to choose the purpose of the application policy. To do this, select the <strong>'Application Policy'</strong> dropdown.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">And select the option <strong>'Certificate Request Agent'</strong>.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Now, we need to make sure that the user or group</span></span> we want to designate as enrollment agent has read and enroll permissions assigned on this template. To do this, first select the <strong>'Security'</strong> tab.</li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">In this case, we don't just want to designate a single user as an enrollment agent, but rather an entire   group of users. However, the group we want to designate is not in the list, so we need to add it. To do this, press the <strong>'Add...'</strong> button.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Then type in the group, which in this case is <strong>'help desk'</strong>.</span></span></li>
                <br>
                <li>Press <strong>'OK'</strong>.</li>
              </ul>
            <p>&nbsp;</p></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Now that the group we want to designate as enrollment agent is in the list, we need to make sure this group has both 'Read' and 'Enroll' permissions. The group already has 'Read', but needs 'Enroll'. To assign the group 'Enroll' permissions, select the <strong>'Enroll'</strong> option under the 'Allow' column.</span></span></li>
        </ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Then press <strong>'OK'</strong>.</span></span></li></ul></td>
                
                <td align="right">
              <table width="404" border="0">
                        <tr>
                            <td align="center">&nbsp;</td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
      
    </body>
</html>