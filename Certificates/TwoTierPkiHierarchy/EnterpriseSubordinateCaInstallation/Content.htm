<html>
	<head>
		<title>Content</title>
	</head>
  	<body>
	
    <table width="100%" border="0" cellpadding="10">
            <tr>
                <td width="100%" align="left" valign="top">To learn how to add  'Active Directory Certificate Services' to a server, proceed with the following steps...</td>
                
                
          </tr>
        </table>
    
    	<hr>
    
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Begin first by selecting <strong>'Start'</strong> at the bottom left corner of your  screen.</span></li>
            </ul>                  <br></td>
                
                <td align="right">
                    <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/1.jpg" width="278" height="128"></td>
                        </tr>
                  </table>
              </td>
          </tr>
        </table>
        
        <hr> 
   
		<table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Then go to <strong>'Administrative Tools'</strong>...</span></li>
                </ul></td>
                
                <td align="right">
                  <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/2.jpg" width="405" height="456"></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        
        <hr> 
		
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Then <strong>'Server Manager'</strong>...</span></li>
                </ul></td>
                
                <td align="right">
              <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/3.jpg" width="250" height="384"></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        
        <hr> 
        
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Once in Server Manager, select <strong>'Roles'</strong> at the upper left corner of  your screen.</span></li>
                </ul></td>
                
                <td align="right">
              <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="1.jpg" width="203" height="178"></td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Then, at the far right side of your screen, select <strong>'Add Roles'</strong> to  launch the Add Roles Wizard.</span></li>
                </ul></td>
                
                <td align="right">
              <table width="405" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/5.jpg" width="257" height="118"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">The first screen of the wizard asks you to verify if this server  is properly configured.</span></li>
                  <br>
                  <li>Click<strong> 'Next'</strong>.</li>
              </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="../../../ActiveDirectory/InstallingActiveDirectory/AddingActiveDirectoryDomainServices/6.jpg" width="780" height="575"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
                <td width="100%" align="left" valign="top"><ul>
                  <li><span dir="LTR">Select the <strong>'Active Directory Certificate Services'</strong> option.</span></li>
                  <br>
                  <li>Then press <strong>'Next &gt;'</strong>.</li>
              </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="../OfflineStandaloneRootCaInstallation/1.jpg" width="780" height="575"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul type="disc">
                <li><span dir="LTR">This screen of the wizard gives a brief introduction to Active Directory Certificate Services. </span></li>
                <br>
                <li><span dir="LTR">Click <strong>'Next &gt;'</strong>.</span></li>
      </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="../OfflineStandaloneRootCaInstallation/2.jpg" width="780" height="575"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>On this screen, the wizard will ask which components of 'Active Directory Certificate Services' you want to install. In this case, we want to install  the first component, <strong>'Certification Authority'</strong>. This is the core component, and  is required in order to use 'Active Directory Certificate Services'.</li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="../OfflineStandaloneRootCaInstallation/3.jpg" width="780" height="575"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
              <li>And we want to select this option, <strong>'Certification Authority Web Enrollment'</strong>. This is an additional service that provides a simple Web interface allowing users to perform tasks such as requests and renew certificates, retrieve certificate revocation lists (CRLs), and enroll smart card certificates.</li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="2.jpg" width="780" height="575"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
              <li><span dir="LTR"><span dir="LTR">Once 'Certification Authority Web Enrollment'</span></span> has been selected, a dialogue box will appear alerting you that IIS is also required to be installed when installing 'Certification Authority Web Enrollment'. Press the <strong>'Add Required Role Services'</strong> button to continue.</li>
            </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="5.jpg" width="625" height="308"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Click <strong>'Next &gt;'</strong>.</span></li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="6.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>On this next screen, you'll need to decide if the CA will be an 'Enterprise' or 'Standalone' CA. If this server is a member of a domain, the wizard will select the <strong>'Enterprise'</strong> option by default, which is the case in this example. Since this is what we want, we will leave this option selected and move on.</li>
                <br>
                <li><span dir="LTR">Click&nbsp;<strong>'Next &gt;'</strong>.</span></li>
        </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="7.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">On this screen, we need to decide if we are going to add an additional subordinate CA or install the root CA. In this case, we already have a Root CA, therefore, we will select the <strong>'Subordinate CA'</strong> option.</span></span></li>
                <br>
                <li><span dir="LTR">Click&nbsp;<strong>'Next &gt;'</strong>.</span></li>
    </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="8.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">The next screen asks if a new private key is to be created or if an existing private key is to be used. In this case, a new private key needs to be created. If there was a situation where the CA had to be recovered, and had a copy of the old private key, the second option could be used to recover the  CA.</span></span></li>
                <br>
                <li><span dir="LTR">Click&nbsp;<strong>'Next &gt;'</strong>.</span></li>
        </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="9.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
            <li>On the next screen, you can choose what type of encryption you want to use for the private key. This first option,&nbsp;<strong>'Select a cryptographic service provider'</strong>, allows you to select the algorithm that is used to create the certificate.</li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="10.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
            <li>The default choice is,&nbsp;<strong>'RSA#Microsoft Software Key Storage Provider'</strong>. Any provider listed that has a hash in the name, is referred to as a 'Cryptography Next Generation' or (CNG). This means more features than the non (CNG) providers, but also means less operating system support. (CNG) requires Windows Vista or Windows Server 2008 and above. This includes other CAs, for example a subordinate CA. If you are using earlier operating systems for subordinate CAs or clients, you will need to select a different option. In this case, the default will work well for this network.</li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="10b.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
            <li>The next option is the length of key. A larger key length will give you better security, but will increase the time taken to generate and check signatures on certificates. Also remember, that if you are planning to use the certificates with hardware like VPN devices, these devices may have limits on how long the key length can be.</li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="10c.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><strong>'2048'</strong>&nbsp;has good software and hardware support, so we will leave it on this option and move on.</li>
          </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="10d.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
            <li>The next option determines the hash algorithm that is used to sign certificates.</li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="10e.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>The default is&nbsp;<strong>'SHA1'</strong>. This once again, comes down to what your client's certificates support. The option you choose here will determine which clients can use these certificates.</li>
        </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="10f.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>This last option,&nbsp;<strong>'Allow administrator interaction when the private key is accessed by the CA.'</strong>, is an option you can select to improve the security of the private key. When you select this option, any certificate interaction performed by this server will require an administrator password to be entered in order for the operation to be performed. For example, if the CA where to issue a certificate, the administrator would be required to enter in a password before the certificate could be issued. This increases the security of the CA. On a root CA, this is not a bad option to have on, as the root CA will not be issuing too many certificates. On a CA that issues a lot of certificates to clients, you would not select this option, as it would require an administrator to enter the password every time a certificate is issued. This would quickly become a lot of work on a busy CA.</li>
                <br>
                <li><span dir="LTR">Click <strong>'Next &gt;'</strong>.</span></li>
    </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="10g.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
            <li>On the next screen, you need to enter in a common name. The wizard will automatically enter in a name for you, but you can change it to your likings if you wish.</li></ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="11.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>In this case, we will name the CA&nbsp;<strong>'IssuingCA'</strong>. This name will be used by all certificates that are issued from this hierarchy, and can not be changed later on. For this reason, you should choose a good name.</li>
                <br>
                <li><span dir="LTR">Click&nbsp;<strong>'Next &gt;'</strong>.</span></li>
    </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="12.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>On the next screen, we need to request a certificate for this subordinate CA from a parent CA. However, since the parent CA is not contactable because of it being offline, we have to save a certificate request to a file and manually send it to the parent CA at a later time. In order the do this, we need to select the option, <strong>'Save a certificate request to file and manually send it later to a parent CA:'</strong>. Selecting this option will save the certificate request to the 'C' drive by default. You can change its destination if you wish, but we will leave it on the default and move on.</li>
      </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="13.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Click <strong>'Next &gt;'</strong>.</span></li>
      </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="14.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>On the next screen, you need to enter in the location for the certificate database. For performance reasons, it is&nbsp;<span dir="LTR"> </span>recommended to put these files on a separate hard disk. Since subordinate CAs could  issues a lot of certificates, it may be a good idea to consider storing the certificates on a separate hard disk, but for this example we will leave it on the default and move on.</li>
                <br>
                <li><span dir="LTR">Click&nbsp;<strong>'Next &gt;'</strong>.</span></li>
  </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="15.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR"><span dir="LTR">Since we are installing  'Certification Authority Web Enrollment'</span></span>, IIS is  required to be installed. This next screen gives you an introduction to IIS.</li>
                <br>
                <li><span dir="LTR">Click&nbsp;<strong>'Next &gt;'</strong>.</span></li>
        </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="16.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>On this next screen, you are asked to choose the appropriate role services you want to install with IIS. In this case, we will go with the default selections and move on.</li>
                <br>
                <li><span dir="LTR">Click&nbsp;<strong>'Next &gt;'</strong>.</span></li>
              </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="17.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>On the next and final screen of the wizard, the wizard will display all the options you chose, and also notice there is a warning message. This message indicates that once the install is complete, you will not be able to change the computer name or domain options for this computer. For this reason, ensure that you have selected an appropriate name for the server before you finish the wizard.</li>
                <br>
                <li><span dir="LTR">Press&nbsp;<strong>'Install'</strong>.</span></li>
    </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="18.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li><span dir="LTR">Wait while the Add Roles Wizard installs 'Active Directory Certificate Services</span>' and 'IIS'.</li>
    </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="19.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
        <hr>
        
        <table width="100%" border="0">
            <tr>
              <td width="100%" align="left" valign="top"><ul>
                <li>View the installation results and then click the&nbsp;<strong>'Close'</strong>&nbsp;button.</li>
    </ul></td>
                
                <td align="right">
              <table width="780" border="0">
                        <tr>
                            <td align="center"><img src="20.jpg" width="780" height="587"></td>
                        </tr>
                  </table>
                </td>
            </tr>
        </table>
        
    </body>
</html>